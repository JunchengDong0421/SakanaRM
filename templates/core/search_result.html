{% extends 'base.html' %}
{% block title %}
    Search Results
{% endblock %}

{% block style %}
    <style>
        table, th, td {
            border: 1px solid black;
        }
    </style>
{% endblock %}

{% block content %}
    {% if err_msg %}
        <h2 style="color: red">Error: {{ err_msg }}</h2>
        <a href="{% url 'core:search-page' %}">Go back</a>
        <a href="" id="close-link">Close</a>
    {% else %}

        <h2>Search Result Count: {{ papers|length }}</h2>

        {% if papers %}
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Owner</th>
                        <th>Tags</th>
                        <th>Last modified</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for p in papers %}
                        <tr>
                            <td>{{ p.title }}</td>
                            <td>{{ p.owner.auth_user.username }}</td>
                            <td>[{% for t in p.tags.all %}{{ t.name }}; {% endfor %}]</td>
                            <td>{{ p.last_modified }}</td>
                            <td><a href="{% url 'core:paper-detail' p.id %}" target="_blank">View</a></td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
            <h3>No matched results.</h3>
        {% endif %}

    {% endif %}

    <script>
        $(document).ready(() => {
            $("#close-link").on("click", () => {
                window.close();
            })
        })
    </script>
{% endblock %}